(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[908],{6955:(e,t,r)=>{"use strict";r.d(t,{S:()=>i});let a="https://warkop-be.vercel.app/api",i={jobs:"".concat(a,"/jobs"),candidates:"".concat(a,"/candidates"),interviewers:"".concat(a,"/interviewers"),users:"".concat(a,"/users"),resume:"".concat(a,"/resume")}},7961:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var a=r(7876),i=r(4232),n=r(9099),s=r(7326),o=r(6955);function l(){let e=(0,n.useRouter)(),{id:t}=e.query,[r,l]=(0,i.useState)(!1),[c,m]=(0,i.useState)(null),[d,u]=(0,i.useState)([]),[b,p]=(0,i.useState)({title:"",location:"",teamDescription:"",jobDescription:"",responsibilities:[""],recruitmentTeam:{teamName:"",manager:"",interviewers:[{name:"",department:""}]}});(0,i.useEffect)(()=>{t&&(async()=>{try{var e,r;let a=s.y.getToken();if(!a)throw Error("No authentication token found");let i=await fetch("".concat(o.S.jobs,"/").concat(t),{headers:{Authorization:"Bearer ".concat(a)}});if(!i.ok){let e=await i.text();throw Error("Failed to fetch job data: ".concat(e))}let n=i.headers.get("content-type");if(!n||!n.includes("application/json"))throw Error("Server response was not JSON");let l=await i.json();u(l.interviewers),p({title:l.title,location:l.location,teamDescription:l.teamDescription,jobDescription:l.jobDescription,responsibilities:l.responsibilities,recruitmentTeam:{teamName:l.recruitmentTeamName||(null==(e=l.recruitmentTeam)?void 0:e.teamName)||"",manager:l.recruitmentManager||(null==(r=l.recruitmentTeam)?void 0:r.manager)||"",interviewers:l.interviewers.map(e=>({id:e.id,name:e.name,department:e.department}))}})}catch(e){console.error("Error fetching job data:",e),m(e instanceof Error?e.message:"An error occurred")}})()},[t]);let h=async r=>{r.preventDefault(),l(!0),m(null);try{let r=s.y.getToken();if(!r)throw Error("No authentication token found");let a=await fetch("".concat(o.S.jobs,"/").concat(t),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify({title:b.title,location:b.location,teamDescription:b.teamDescription,jobDescription:b.jobDescription,responsibilities:b.responsibilities,recruitmentTeamName:b.recruitmentTeam.teamName,recruitmentManager:b.recruitmentTeam.manager})});if(!a.ok){let e=await a.text();throw Error("Failed to update job: ".concat(e))}let i=b.recruitmentTeam.interviewers.filter(e=>e.id),n=b.recruitmentTeam.interviewers.filter(e=>!e.id),l=d.filter(e=>!i.some(t=>t.id===e.id));await Promise.all(l.map(async e=>{let t=await fetch("".concat(o.S.interviewers,"/").concat(e.id),{method:"DELETE",headers:{Authorization:"Bearer ".concat(r)}});if(!t.ok){let e=await t.text();throw Error("Failed to delete interviewer: ".concat(e))}})),await Promise.all(i.map(async e=>{let t=await fetch("".concat(o.S.interviewers,"/").concat(e.id),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify({name:e.name,department:e.department})});if(!t.ok){let e=await t.text();throw Error("Failed to update interviewer: ".concat(e))}})),await Promise.all(n.map(async e=>{let a=await fetch(o.S.interviewers,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify({jobId:t,name:e.name,department:e.department})});if(!a.ok){let e=await a.text();throw Error("Failed to add interviewer: ".concat(e))}})),await e.push("/dashboard")}catch(e){console.error("Error updating job:",e),m(e instanceof Error?e.message:"An error occurred while updating the job")}finally{l(!1)}},x=(e,t)=>{let r=[...b.responsibilities];r[e]=t,p(e=>({...e,responsibilities:r}))},g=(e,t,r)=>{let a=[...b.recruitmentTeam.interviewers];a[e]={...a[e],[t]:r},p(e=>({...e,recruitmentTeam:{...e.recruitmentTeam,interviewers:a}}))};return(0,a.jsx)("div",{className:"min-h-screen bg-[#FAFAFA]",children:(0,a.jsxs)("main",{className:"max-w-4xl mx-auto px-8 py-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-8",children:"Edit Lowongan"}),c&&(0,a.jsx)("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg text-red-600",children:c}),(0,a.jsxs)("form",{onSubmit:h,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[(0,a.jsx)("h2",{className:"font-bold text-lg mb-4",children:"Informasi Dasar"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Judul Pekerjaan"}),(0,a.jsx)("input",{type:"text",value:b.title,onChange:e=>p(t=>({...t,title:e.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lokasi"}),(0,a.jsx)("input",{type:"text",value:b.location,onChange:e=>p(t=>({...t,location:e.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[(0,a.jsx)("h2",{className:"font-bold text-lg mb-4",children:"Deskripsi"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Deskripsi Tim"}),(0,a.jsx)("textarea",{value:b.teamDescription,onChange:e=>p(t=>({...t,teamDescription:e.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 h-32",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Deskripsi Pekerjaan"}),(0,a.jsx)("textarea",{value:b.jobDescription,onChange:e=>p(t=>({...t,jobDescription:e.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 h-32",required:!0})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[(0,a.jsx)("h2",{className:"font-bold text-lg mb-4",children:"Tanggung Jawab"}),b.responsibilities.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)("input",{type:"text",value:e,onChange:e=>x(t,e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0}),b.responsibilities.length>1&&(0,a.jsx)("button",{type:"button",onClick:()=>p(e=>({...e,responsibilities:e.responsibilities.filter((e,r)=>r!==t)})),className:"px-2 py-1 bg-red-500 text-white rounded-lg hover:bg-red-600",children:"Hapus"})]},t)),(0,a.jsx)("button",{type:"button",onClick:()=>{p(e=>({...e,responsibilities:[...e.responsibilities,""]}))},className:"mt-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:"Tambah Tanggung Jawab"})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[(0,a.jsx)("h2",{className:"font-bold text-lg mb-4",children:"Tim Rekrutmen"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Tim"}),(0,a.jsx)("input",{type:"text",value:b.recruitmentTeam.teamName,onChange:e=>p(t=>({...t,recruitmentTeam:{...t.recruitmentTeam,teamName:e.target.value}})),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Manager"}),(0,a.jsx)("input",{type:"text",value:b.recruitmentTeam.manager,onChange:e=>p(t=>({...t,recruitmentTeam:{...t.recruitmentTeam,manager:e.target.value}})),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]})]}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("h3",{className:"font-semibold mb-2",children:"Interviewers"}),b.recruitmentTeam.interviewers.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)("input",{type:"text",placeholder:"Nama Interviewer",value:e.name,onChange:e=>g(t,"name",e.target.value),className:"w-1/2 px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0}),(0,a.jsx)("input",{type:"text",placeholder:"Departemen",value:e.department,onChange:e=>g(t,"department",e.target.value),className:"w-1/2 px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0}),b.recruitmentTeam.interviewers.length>1&&(0,a.jsx)("button",{type:"button",onClick:()=>p(e=>({...e,recruitmentTeam:{...e.recruitmentTeam,interviewers:e.recruitmentTeam.interviewers.filter((e,r)=>r!==t)}})),className:"px-2 py-1 bg-red-500 text-white rounded-lg hover:bg-red-600",children:"Hapus"})]},t)),(0,a.jsx)("button",{type:"button",onClick:()=>{p(e=>({...e,recruitmentTeam:{...e.recruitmentTeam,interviewers:[...e.recruitmentTeam.interviewers,{name:"",department:""}]}}))},className:"mt-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:"Tambah Interviewer"})]})]}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)("button",{type:"submit",className:"px-6 py-2 bg-black text-white rounded-lg hover:bg-gray-900 flex items-center gap-2",disabled:r,children:r?"Menyimpan...":"Simpan Perubahan"})})]})]})})}},8600:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/job/[id]/edit",function(){return r(7961)}])},9099:(e,t,r)=>{e.exports=r(8253)}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(8600)),_N_E=e.O()}]);